```mermaid
graph TB
    subgraph "Client Layer"
        WebApp[Web Application<br/>Next.js 16 + React 19]
        PWA[Progressive Web App<br/>Offline Support]
    end

    subgraph "Transfer Methods"
        P2P[P2P Direct Transfer<br/>WebRTC Data Channels]
        Local[Local Network<br/>mDNS Discovery]
        Email[Email Fallback<br/>Encrypted S3 Upload]
    end

    subgraph "Signaling Layer"
        Signal[Signaling Server<br/>Socket.IO]
        STUN[STUN/TURN Servers<br/>NAT Traversal]
    end

    subgraph "Crypto Layer"
        PQC[Post-Quantum Crypto<br/>ML-KEM-768 + X25519]
        Ratchet[Triple Ratchet<br/>Forward Secrecy]
        FileEnc[File Encryption<br/>AES-256-GCM]
    end

    subgraph "Privacy Layer"
        Onion[Onion Routing<br/>3-Hop Relays]
        Metadata[Metadata Stripping<br/>EXIF/GPS Removal]
        SecDel[Secure Deletion<br/>DoD 5220.22-M]
    end

    subgraph "Storage Layer"
        IndexDB[(IndexedDB<br/>Transfer History)]
        SecStore[(Secure Storage<br/>Encrypted Keys)]
        S3[(AWS S3<br/>Email Fallback)]
    end

    subgraph "External Services"
        Resend[Resend<br/>Email Delivery]
        Stripe[Stripe<br/>Donations]
        Metrics[Prometheus<br/>Monitoring]
        Sentry[Sentry<br/>Error Tracking]
    end

    %% Connections
    WebApp --> P2P
    WebApp --> Local
    WebApp --> Email
    WebApp --> PWA

    P2P --> Signal
    P2P --> STUN
    P2P --> PQC

    PQC --> Ratchet
    Ratchet --> FileEnc

    WebApp --> Onion
    WebApp --> Metadata
    WebApp --> SecDel

    WebApp --> IndexDB
    WebApp --> SecStore
    Email --> S3

    Email --> Resend
    WebApp --> Stripe
    WebApp --> Metrics
    WebApp --> Sentry

    %% Styling
    classDef client fill:#3b82f6,stroke:#1e40af,stroke-width:2px,color:#fff
    classDef transfer fill:#10b981,stroke:#047857,stroke-width:2px,color:#fff
    classDef crypto fill:#f59e0b,stroke:#b45309,stroke-width:2px,color:#fff
    classDef privacy fill:#8b5cf6,stroke:#5b21b6,stroke-width:2px,color:#fff
    classDef storage fill:#ec4899,stroke:#be185d,stroke-width:2px,color:#fff
    classDef external fill:#6b7280,stroke:#374151,stroke-width:2px,color:#fff

    class WebApp,PWA client
    class P2P,Local,Email,Signal,STUN transfer
    class PQC,Ratchet,FileEnc crypto
    class Onion,Metadata,SecDel privacy
    class IndexDB,SecStore,S3 storage
    class Resend,Stripe,Metrics,Sentry external
```
