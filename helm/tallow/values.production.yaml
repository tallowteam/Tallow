# Production values for tallow

global:
  domain: tallow.manisahome.com

image:
  registry: ghcr.io
  repository: your-username/tallow
  pullPolicy: IfNotPresent
  tag: "1.0.0"  # Use specific version in production

web:
  replicaCount: 5

  resources:
    requests:
      cpu: 1000m
      memory: 1Gi
    limits:
      cpu: 4000m
      memory: 4Gi

  autoscaling:
    minReplicas: 5
    maxReplicas: 20
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  podDisruptionBudget:
    minAvailable: 3

  env:
    NODE_ENV: production
    NEXT_TELEMETRY_DISABLED: "1"

signaling:
  replicaCount: 4

  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 2000m
      memory: 1Gi

  autoscaling:
    minReplicas: 4
    maxReplicas: 12
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  podDisruptionBudget:
    minAvailable: 2

  env:
    SIGNALING_PORT: "3001"
    ALLOWED_ORIGINS: "https://tallow.manisahome.com"

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
    nginx.ingress.kubernetes.io/limit-rps: "50"
    nginx.ingress.kubernetes.io/rate-limit: "100"

networkPolicy:
  enabled: true

monitoring:
  enabled: true
  prometheus:
    enabled: true

# Production affinity to spread across nodes
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: app.kubernetes.io/name
              operator: In
              values:
                - tallow
        topologyKey: kubernetes.io/hostname

# Node selector for production nodes
nodeSelector:
  node-role: production

# Tolerations for production taints
tolerations:
  - key: "production"
    operator: "Equal"
    value: "true"
    effect: "NoSchedule"
