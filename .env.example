# ============================================================================
# Tallow Environment Configuration
# Copy this file to .env and fill in your values
# ============================================================================

# ----------------------------------------------------------------------------
# Application Environment
# ----------------------------------------------------------------------------
NODE_ENV=production
NEXT_TELEMETRY_DISABLED=1

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
PORT=3000
HOSTNAME=0.0.0.0

# ----------------------------------------------------------------------------
# API Security
# ----------------------------------------------------------------------------
# Secret key for API authentication (protects email endpoints from spam)
# Generate: node -e "console.log(crypto.randomBytes(32).toString('hex'))"
# Or use: openssl rand -hex 32
API_SECRET_KEY=

# ----------------------------------------------------------------------------
# Signaling/Relay Server
# WebSocket server URL for P2P connection signaling
# For Docker: ws://signaling:3001
# For local dev: ws://localhost:3001
# For production: wss://relay.yourdomain.com
# ----------------------------------------------------------------------------
NEXT_PUBLIC_SIGNALING_URL=ws://signaling:3001

# Force all connections through relay (disable direct P2P)
NEXT_PUBLIC_FORCE_RELAY=true

# Allow direct P2P connections when possible
NEXT_PUBLIC_ALLOW_DIRECT=false

# Relay server role (any, entry, middle, exit)
RELAY_ROLE=any

# Relay server region for geo-routing
RELAY_REGION=us-west

# ----------------------------------------------------------------------------
# TURN Server Configuration
# Required for NAT traversal when direct connections fail
# Use services like Twilio, Metered.ca, or self-hosted coturn
# ----------------------------------------------------------------------------
NEXT_PUBLIC_TURN_SERVER=turns:turn.example.com:443?transport=tcp
NEXT_PUBLIC_TURN_USERNAME=your-turn-username
NEXT_PUBLIC_TURN_CREDENTIAL=your-turn-credential

# ----------------------------------------------------------------------------
# Email Service (Resend)
# Get API key from: https://resend.com/api-keys
# ----------------------------------------------------------------------------
RESEND_API_KEY=re_1234567890abcdef
RESEND_FROM_EMAIL=Tallow <noreply@yourdomain.com>

# Maximum file size for direct email attachments (25MB)
NEXT_PUBLIC_MAX_ATTACHMENT_SIZE=25000000
# Maximum total file size for email transfer (100MB)
NEXT_PUBLIC_MAX_EMAIL_FILE_SIZE=100000000

# ----------------------------------------------------------------------------
# AWS S3 Cloud Storage (Required for Email Fallback)
# ----------------------------------------------------------------------------
# AWS credentials for S3 storage of encrypted email transfers
# Create IAM user: https://console.aws.amazon.com/iam/
# Grant: s3:PutObject, s3:GetObject, s3:DeleteObject, s3:ListBucket
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_REGION=us-east-1
AWS_S3_BUCKET=tallow-uploads

# ----------------------------------------------------------------------------
# Stripe Payment Integration
# Get keys from: https://dashboard.stripe.com/apikeys
# ----------------------------------------------------------------------------
STRIPE_SECRET_KEY=sk_live_1234567890abcdef
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_1234567890abcdef
STRIPE_WEBHOOK_SECRET=whsec_1234567890abcdef

# ----------------------------------------------------------------------------
# Security Configuration
# ----------------------------------------------------------------------------
# Comma-separated list of allowed origins for CORS
ALLOWED_ORIGINS=https://tallow.app,https://www.tallow.app

# ----------------------------------------------------------------------------
# LaunchDarkly Feature Flags
# Get keys from: https://app.launchdarkly.com/settings/projects
# ----------------------------------------------------------------------------
NEXT_PUBLIC_LAUNCHDARKLY_CLIENT_ID=1234567890abcdef

# ----------------------------------------------------------------------------
# Error Tracking & Analytics (Optional)
# ----------------------------------------------------------------------------
# Sentry DSN for error tracking
NEXT_PUBLIC_SENTRY_DSN=https://public@sentry.example.com/1

# Application version
NEXT_PUBLIC_APP_VERSION=1.0.0

# Plausible Analytics (privacy-first, no cookies, GDPR compliant)
# Your website domain (as configured in Plausible dashboard)
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=tallow.yourdomain.com
# Optional: Custom API host if self-hosting Plausible
NEXT_PUBLIC_PLAUSIBLE_API_HOST=https://plausible.io

# ----------------------------------------------------------------------------
# Cloudflare Tunnel (Optional - for Synology NAS)
# ----------------------------------------------------------------------------
# Get token from: https://one.dash.cloudflare.com/
# Navigate to Networks -> Tunnels -> Create a tunnel
CLOUDFLARE_TUNNEL_TOKEN=eyJhIjoiYWJjZGVmMTIzNDU2...

# ----------------------------------------------------------------------------
# Database (Optional - if you add persistent storage)
# ----------------------------------------------------------------------------
DATABASE_URL=postgresql://user:password@localhost:5432/tallow

# ----------------------------------------------------------------------------
# Redis (Optional - for caching/sessions)
# ----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379

# ----------------------------------------------------------------------------
# Development Settings
# ----------------------------------------------------------------------------
# Enable debug logs
NEXT_PUBLIC_DEBUG=false

# ----------------------------------------------------------------------------
# Production Checklist
# ----------------------------------------------------------------------------
# Before deploying to production:
# 1. [ ] Generate and set API_SECRET_KEY for API authentication
# 2. [ ] Set RESEND_API_KEY for email functionality
# 3. [ ] Configure AWS S3 for email fallback storage
# 4. [ ] Configure TURN server with valid credentials
# 5. [ ] Set up Cloudflare Tunnel on Synology NAS
# 6. [ ] Update ALLOWED_ORIGINS with your domain
# 7. [ ] Set NEXT_PUBLIC_SIGNALING_URL to wss://relay.yourdomain.com
# 8. [ ] Verify HTTPS is working (required for WebRTC)
# 9. [ ] Test WebRTC connectivity with FORCE_RELAY=true
# 10. [ ] Set up error tracking with Sentry
# 11. [ ] Configure analytics with Plausible
# 12. [ ] Set up LaunchDarkly for feature flag management
