# Tallow Environment Configuration
# Copy this file to .env.local and fill in your values

# =============================================================================
# API Security
# =============================================================================
# Secret key for API authentication (protects email endpoints from spam)
# Generate a secure key: node -e "console.log(crypto.randomBytes(32).toString('hex'))"
# Or use: openssl rand -hex 32
API_SECRET_KEY=

# =============================================================================
# Error Tracking (Optional but Recommended)
# =============================================================================
# Sentry DSN for error tracking and performance monitoring
# Sign up at: https://sentry.io/
# Create a Next.js project and copy the DSN
NEXT_PUBLIC_SENTRY_DSN=

# Application version for release tracking
NEXT_PUBLIC_APP_VERSION=1.0.0

# =============================================================================
# Email Service (Optional but Recommended)
# =============================================================================
# Resend API key for sending welcome emails and file transfer fallback
# Get your key from: https://resend.com/
# Required for email fallback when P2P transfers fail
RESEND_API_KEY=

# Email fallback configuration
# Maximum file size for direct email attachments (25MB is Resend's safe limit)
NEXT_PUBLIC_MAX_ATTACHMENT_SIZE=25000000
# Maximum total file size for email transfer (100MB)
NEXT_PUBLIC_MAX_EMAIL_FILE_SIZE=100000000

# =============================================================================
# AWS S3 Cloud Storage (Required for Email Fallback)
# =============================================================================
# AWS credentials for S3 storage of encrypted email transfers
# Create an IAM user with S3 access at: https://console.aws.amazon.com/iam/
# Grant permissions: s3:PutObject, s3:GetObject, s3:DeleteObject, s3:ListBucket
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# AWS region where your S3 bucket is located (e.g., us-east-1, eu-west-1)
AWS_REGION=us-east-1

# S3 bucket name for storing encrypted temporary files
# Create a bucket at: https://s3.console.aws.amazon.com/s3/
# Recommended: Enable versioning and lifecycle rules to auto-delete old files
AWS_S3_BUCKET=

# Note: If S3 is not configured, the system will fall back to localStorage
# This is only suitable for development. Production MUST use S3 or similar cloud storage.

# =============================================================================
# TURN Server Configuration (Required for Production)
# =============================================================================
# TURN servers relay WebRTC traffic to prevent IP address leaks.
# Without TURN credentials, users behind strict NATs may not connect.
#
# Free TURN providers:
#   - Metered: https://www.metered.ca/stun-turn (recommended)
#   - Xirsys: https://xirsys.com/
#   - Twilio: https://www.twilio.com/stun-turn
#
# Format: turns:<host>:<port>?transport=tcp (or turn: for UDP)
NEXT_PUBLIC_TURN_SERVER=turns:relay.metered.ca:443?transport=tcp

# TURN credentials from your provider
# These are public because they're sent to the browser for WebRTC
NEXT_PUBLIC_TURN_USERNAME=your-turn-username
NEXT_PUBLIC_TURN_CREDENTIAL=your-turn-credential

# =============================================================================
# Privacy Settings
# =============================================================================
# Force all WebRTC connections through TURN relay (hides IP addresses)
# Set to 'false' to allow direct peer connections (faster but exposes IPs)
NEXT_PUBLIC_FORCE_RELAY=true

# Allow direct connections when relay fails
# Set to 'true' as fallback for better connectivity at cost of privacy
NEXT_PUBLIC_ALLOW_DIRECT=false

# =============================================================================
# Stripe Donations (Optional)
# =============================================================================
# Stripe publishable key (safe for client-side)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
# Stripe secret key (server-side only)
STRIPE_SECRET_KEY=sk_test_...
# Stripe webhook signing secret
STRIPE_WEBHOOK_SECRET=whsec_...

# =============================================================================
# Analytics & Monitoring (Optional)
# =============================================================================
# Plausible Analytics - Privacy-first analytics
# Sign up at: https://plausible.io/
# Your domain name (e.g., tallow.example.com)
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=
# Plausible host (default: https://plausible.io)
# Use custom domain if self-hosting
NEXT_PUBLIC_PLAUSIBLE_HOST=https://plausible.io

# Prometheus Metrics
# Optional: Add bearer token for metrics endpoint authentication
# METRICS_TOKEN=your-secret-token

# =============================================================================
# Feature Flags (Optional)
# =============================================================================
# LaunchDarkly - Feature flag management
# Sign up at: https://launchdarkly.com/
# Client-side ID from your LaunchDarkly project settings
# Note: If not configured, the app uses default feature flags (all features enabled)
# No console warnings will appear when this is not set
NEXT_PUBLIC_LAUNCHDARKLY_CLIENT_ID=

# =============================================================================
# Development Settings
# =============================================================================
# Enable debug logs in development (shows all console.debug messages)
# Set to 'true' to see LaunchDarkly initialization and other debug info
# By default, debug logs are hidden for a cleaner console
# You can also enable this in the browser console:
#   localStorage.setItem('DEBUG', 'true')
NEXT_PUBLIC_DEBUG=false

# =============================================================================
# Production Checklist
# =============================================================================
# Before deploying to production:
# 1. [ ] Generate and set API_SECRET_KEY for API authentication
# 2. [ ] Set RESEND_API_KEY for email functionality
# 3. [ ] Configure TURN server with valid credentials
# 4. [ ] Verify HTTPS is working (required for HSTS)
# 5. [ ] Test WebRTC connectivity with FORCE_RELAY=true
# 6. [ ] Set up Plausible Analytics for privacy-first tracking
# 7. [ ] Configure LaunchDarkly for feature flag management
# 8. [ ] Set up Prometheus metrics scraping (optional)
